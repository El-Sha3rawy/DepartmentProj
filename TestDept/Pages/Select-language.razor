@page "/Select-language"
@inject NavigationManager Navigation
@inject IJSRuntime JS

<h3>اختر لغتك / Select Language</h3>

<select @bind="selectedCulture" class="border border-gray-300 rounded-lg p-2 mb-4">
    <option value="en">English</option>
    <option value="ar">العربية</option>
</select>

<button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
        @onclick="ConfirmLanguage">
    تأكيد / Confirm
</button>

@code {
    private string selectedCulture = "en";

    protected override async Task OnInitializedAsync()
    {
        var savedCulture = await JS.InvokeAsync<string>("localStorage.getItem", "culture");
        if (!string.IsNullOrEmpty(savedCulture))
        {
            selectedCulture = savedCulture;
        }
    }

    private async Task ConfirmLanguage()
    {
        
        await JS.InvokeVoidAsync("localStorage.setItem", "culture", selectedCulture);

        var cultureInfo = new System.Globalization.CultureInfo(selectedCulture);
        System.Globalization.CultureInfo.DefaultThreadCurrentCulture = cultureInfo;
        System.Globalization.CultureInfo.DefaultThreadCurrentUICulture = cultureInfo;

        Navigation.NavigateTo("/Department", forceLoad: true);
    }
}
